/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/ctrling@0.8.0/ctrling.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/**
 * ctrling.js (c) 2022 Stefan Goessner
 * @license MIT License
 */
"use strict";class Ctrling extends HTMLElement{static get observedAttributes(){return["ref","width","top","right","darkmode","autoupdate","tickspersecond","callback"]}static updateNextSibling(t){t.target.nextSibling.innerHTML=t.target.value}static stringify(t){return Array.isArray(t)?JSON.stringify(t):"object"==typeof t?JSON.stringify(t).replaceAll(/\[.*?\]/gm,(t=>t.replaceAll(",",";"))).replaceAll(/\:\{([^}]*?)\}/gm,(t=>t.replaceAll(",",";"))).replace(/^\{/gm,"{\n  ").replace(/\}$/gm,"\n}").replaceAll(",",",\n  ").replaceAll(";",","):"string"==typeof t?t:JSON.stringify(t)}constructor(){super().attachShadow({mode:"open"})}get refRoot(){const ref=this.getAttribute("ref")||"",refName=/[A-Za-z_][A-Za-z_0-9]*/.test(ref)?ref:"",refroot=globalThis[refName];return void 0!==refroot?refroot:eval(refName)}get width(){return this.getAttribute("width")||"200px"}set width(t){t&&this.setAttribute("width",t)}get top(){return this.getAttribute("top")||"0px"}get right(){return this.getAttribute("right")||"0px"}get darkmode(){return!!this.hasAttribute("darkmode")||!1}get autoupdate(){return!!this.hasAttribute("autoupdate")||!1}connectedCallback(){setTimeout((()=>this.init()))}disconnectedCallback(){}attributeChangedCallback(t,e,n){}init(){if(this.shadowRoot.innerHTML=Ctrling.template.main({width:this.width,top:this.top,right:this.right,darkmode:this.darkmode}),this.main=this.shadowRoot.querySelector("main"),this.sections=void 0!==this.innerHTML?this.sectionsFromJSON():[],this.style.display="block",this.style.width=this.main.offsetWidth+"px",this.style.height=this.main.offsetHeight+"px",this.hasAttribute("callback")){const[t,e]=this.getRef(this.getAttribute("callback")),n=t&&e&&Object.getOwnPropertyDescriptor(t,e);void 0!==n&&"value"in n&&"function"==typeof t[e]&&(this.setRefValueCallback=t[e],this.setRefValueCallback())}if(this.hasAttribute("tickspersecond")){const t=+this.getAttribute("tickspersecond");Number.isNaN(t)||(Ctrling.timer.ticksPerSecond=t)}}sectionsFromJSON(){try{this.sections=JSON.parse(this.innerHTML);for(let t=0;t<this.sections.length;t++)this.main.append(this.#t(this.sections[t]));return this.sections}catch(t){this.sections=[],this.addSection({sec:"hdr",text:"Ctrling: "+t.message})}return this.sections}idxById(t){return this.sections.findIndex((e=>e.id===t))}sectionById(t){const e=this.sections.findIndex((e=>e.id===t));return e>=0?this.sections[e]:void 0}#t(t){if(t&&t.sec&&Object.hasOwn(Ctrling.prototype,t.sec)){const e=document.createElement("section");return e.setAttribute("class",t.sec),this[t.sec](e,t),e}}addSection(t){const e=this.#t(t);return e&&(this.main.append(e),this.sections.push(t)),this}removeSection(t){return this.main.getElementsByTagName("section")[t]?.remove(),this.sections.splice(t,1),this}updateSection(t,e){if(void 0===e&&(e=this.sections.findIndex((e=>e===t))),e>=0){const n=this.#t(t);n&&this.main.getElementsByTagName("section")[e]?.replaceWith(n)}return this}replaceSection(t,e){const n=this.#t(e);return n&&(this.main.getElementsByTagName("section")[t]?.replaceWith(n),this.sections.splice(t,1,e)),this}getRef(t){const e=t.startsWith("$")?this.refRoot:t.match(/^(window|globalThis)/)?globalThis:void 0;if(e){const n=t.match(/^(\$|window|globalThis)/)&&t.endsWith("]")?t.substring(t.search(/\[/)+1,t.length-1).replaceAll("'","").split("]["):void 0;let i=e;if(n&&n.length>0){for(let t=0;t<n.length-1;t++)i=i[n[t]];return[i,n[n.length-1]]}return[i]}return[]}getRefValue(t,e,n){return t?e?t[e]:t:n}setRefValue(t,e,n){t[e]=!0===n||!1===n||null===n||Number.isNaN(+n)?n:+n,void 0!==this.setRefValueCallback&&this.setRefValueCallback(t,e,n)}#e(t){this.autoupdate?Ctrling.timer.ontick(t):(this.updators||(this.updators=[])).push(t)}update(){if(this.updators)for(const t of this.updators)t()}hdr(t,e){return t.innerHTML=`${e.text||""}`,t}chk(t,e){const[n,i]=this.getRef(e.path);return t.innerHTML=`<label>${e.label}<input type="checkbox" ${this.getRefValue(n,i,e.value)?"checked":""}${e.disabled?" disabled":""}></label>`,t.querySelector("input").addEventListener("input",(t=>this.setRefValue(n,i,!!t.target.checked)),!0),t}col(t,e){const[n,i]=this.getRef(e.path),s=this.getRefValue(n,i,e.value||"#000000");return t.innerHTML=`${e.label}<span><input type="color" value="${s}"${e.disabled?" disabled":""}><output>${s}</output></span>`,t.querySelector("input").addEventListener("input",(t=>{this.setRefValue(n,i,t.target.value),Ctrling.updateNextSibling(t)}),!0),t}num(t,e){const[n,i]=this.getRef(e.path),s=this.getRefValue(n,i,e.value||0),a=(t,e)=>e?t.toFixed(e):t;return t.innerHTML=`<label>${e.label}<span><input type="number" value="${a(s,e.fractions)}"${void 0!==e.min?` min="${e.min}"`:""}${void 0!==e.max?` max="${e.max}"`:""}${void 0!==e.step?` step="${e.step}"`:""}${e.disabled?" disabled":""}>${e.unit?`<span>${e.unit}</span>`:""}</span></label>`,t.querySelector("input").addEventListener("input",(t=>this.setRefValue(n,i,a(+t.target.value,e.fractions))),!0),t.querySelector("input").addEventListener("change",(t=>this.setRefValue(n,i,t.target.value=a(+t.target.value,e.fractions))),!0),t}txt(t,e){const[n,i]=this.getRef(e.path);return t.innerHTML=`<label>${e.label}<input type="text" value="${this.getRefValue(n,i,e.value||"")}"${e.disabled?" disabled":""}></label>`,t.querySelector("input").addEventListener("input",(t=>this.setRefValue(n,i,t.target.value)),!0),t}rng(t,e){const[n,i]=this.getRef(e.path),s=this.getRefValue(n,i,e.value);return t.innerHTML=`${e.label}<span><input type="range" value="${s}"${void 0!==e.min?` min="${e.min}"`:""}${void 0!==e.max?` max="${e.max}"`:""}${void 0!==e.step?` step="${e.step}"`:""}${e.disabled?" disabled":""}><output>${s}</output>${e.unit?`<span>${e.unit}</span>`:""}`,t.querySelector("input").addEventListener("input",(t=>{this.setRefValue(n,i,+t.target.value),Ctrling.updateNextSibling(t)}),!0),t}sel(t,e){const[n,i]=this.getRef(e.path),s=Array.isArray(e.options)?e.options.map((t=>[t,t])):Object.entries(e.options),a=this.getRefValue(n,i,s[0][1]);return t.innerHTML=`${e.label}<select${e.disabled?" disabled":""}>${s.map((t=>`<option value="${t[1]}"${t[1]===a?" selected":""}>${t[0]}</option>`)).join("")}</select>`,t.querySelector("select").addEventListener("input",(t=>this.setRefValue(n,i,isNaN(t.target.value)?t.target.value:+t.target.value)),!0),t}sep(t){return t.innerHTML="<hr>",t}btn(t,e){if(t.innerHTML=`${e.text&&e.label||"&nbsp;"}<button type="button"${e.disabled?" disabled":""}>${e.text||e.label}</button`,e.path&&!e.disabled){const[n,i]=this.getRef(e.path),s=n&&i&&Object.getOwnPropertyDescriptor(n,i);void 0!==s&&"value"in s&&"function"==typeof n[i]&&t.querySelector("button").addEventListener("click",n[i],!0)}return t}out(t,e){const[n,i]=this.getRef(e.path),s=Ctrling.stringify(this.getRefValue(n,i,e.value||""));if(t.innerHTML=`${e.label}<span><output>${s}</output>${e.unit?`<span>${e.unit}</span>`:""}</span>`,void 0!==n){const e=t.querySelector("output");this.#e((()=>{const t=Ctrling.stringify(i?n[i]:n);e.innerHTML!==t&&(e.innerHTML=t)}))}return t}mtr(t,e){const[n,i]=this.getRef(e.path),s=this.getRefValue(n,i,e.value||e.min||0);if(t.innerHTML=`${e.label}<span><meter value="${s}"${void 0!==e.min?` min="${e.min}"`:""}${void 0!==e.max?` max="${e.max}"`:""}${void 0!==e.low?` low="${e.low}"`:""}${void 0!==e.high?` high="${e.high}"`:""}${void 0!==e.optimum?` optimum="${e.optimum}"`:""}></meter><output>${s}</output>${e.unit?`<span>${e.unit}</span>`:""}</span>`,void 0!==n){const e=t.querySelector("meter"),s=t.querySelector("output");this.#e((()=>{const t=i?n[i]:n;e.value!==t&&(e.value=s.value=t)}))}return this}vec(t,e){if(Array.isArray(e.path)&&e.path.length>0){t.innerHTML=`${e.label}<span>${e.path.map((t=>{const[n,i]=this.getRef(t);return`<input type="text" ${n?` value="${Ctrling.stringify(n[i])}"`:""}${e.disabled?" disabled":""}${e.width?` style="width:${e.width}"`:""}>`})).join("")}</span>${e.unit?`<span>${e.unit}</span>`:""}`;const n=t.getElementsByTagName("input");for(let t=0;t<n.length;t++)n[t]._ctrlpath=e.path[t],n[t].addEventListener("input",(t=>{const[e,n]=this.getRef(t.target._ctrlpath);this.setRefValue(e,n,isNaN(t.target.value)?t.target.value:+t.target.value)}),!0)}return t}static template={main:({width:t,top:e,right:n,darkmode:i})=>`\n<style>\nmain {\n    /* grid layout */\n    display: grid;\n    grid: minmax(200px,100%);\n    border-radius:5px;\n    padding: 0 2px 0 2px;\n    width: ${t};\n    min-width: 200px;\n    background-color: ${i?"#444":"#dadada"};\n    overflow: hidden;\n\n    font-family: monospace;\n\n    /* top right corner position */\n    position: absolute;\n    top: ${e};\n    right: ${n};\n    user-select: none;\n}\nmain > section {\n    width: 100%;\n    margin: 2px 0 2px 0;\n}\nmain > section.hdr {\n    text-align: center;\n    font-weight: bold;\n    color: ${i?"#eee":"#444"};\n    background-color: ${i?"#666":"#bbb"};\n    border-radius: 5px 5px 0 0;\n}\nmain > section.btn, \nmain > section.sel, \nmain > section.rng, \nmain > section.col, \nmain > section.out, \nmain > section.mtr,\nmain > section.vec,\nmain > section > label  {\n    display: flex;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    align-items: center;\n    gap: 0.25em;\n\n    color: ${i?"#ddd":"#222"};\n\n    border-radius: 0px;\n    border: none;\n}\nmain > section > span {\n    display: flex;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    align-items: center;\n    gap: 0.1em;\n}\nmain > section input:hover {\n    background-color: ${i?"#666":"#fff"};\n}\nmain > section input:focus-visible {\n    color: ${i?"#eee":"#111"};\n    outline: 1px solid ${i?"#ddd":"#222"}\n}\nmain > section input {\n    background-color: ${i?"#555":"#efefef"};\n    color: ${i?"#ddd":"#222"};\n    border: none;\n}\nmain > section.num input {\n    width: 5em;\n}\nmain > section.col input {\n    width: 2em;\n}\nmain > section.rng input {\n    width: 7em;\n}\nmain > section.vec input {\n    width: 24%;\n}\nmain > section.vec > span {\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: end;\n    gap: 1px;\n    /*background-color: ${i?"#444":"#cdcdcd"};*/\n}\nmain > section.out {\n    min-width: 2em;\n    max-width: 100%;\n    overflow: hidden;\n}\nmain > section.rng output {\n    width: 1.5em;\n    text-align: right;\n}\nmain > section.sep > hr {\n    color: ${i?"#666":"#ccc"};\n    width: 90%;\n}\nmain > section output {\n    background-color: ${i?"#555":"#e6e6e6"};\n    padding: 0 0.25em;\n    font-family: monospace;\n    white-space: pre;\n}\nmain > section select, \nmain > section button {\n    font-family: monospace;\n}\n</style>\n<main></main>`};static timer={t:0,handler:[],rafid:!1,ticksPerSecond:4,ontick(t){this.handler.push(t),this.rafid||this.tick()},tick(){if(Ctrling.timer.t=Ctrling.timer.t++%15,0===Ctrling.timer.t)for(const t of Ctrling.timer.handler)t();Ctrling.timer.rafid=requestAnimationFrame(Ctrling.timer.tick)}}}customElements.define("ctrl-ing",Ctrling);
//# sourceMappingURL=/sm/361c4760ffd6502cc2b04a1a0bbcc38ac75acb8d0a65129ecd960a1c02385950.map